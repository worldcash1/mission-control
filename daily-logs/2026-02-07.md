---
tags:
  - travel
  - projects/marriott-scanner
---

# 2026-02-07

## Marriott MMP Scanning Session

### Dubai (10 hotels)
- Scanned 10 Dubai hotels via browser relay, generated PDF
- Hotel codes: DXBML, DXBPM, DXBAD, DXBHR, DXBLV, DXBMS, DXBGL, DXBMB, DXBJM, DXBRZ
- Sent to #üè®-marriott Discord channel

### Tokyo (6 hotels, March 2026)
- Feb was fully unavailable, used March instead
- Hotels scanned: TYOMC, TYOSI, TYOWI, TYOGZ, TYOHU, TYOAM
- Best deals: Tokyo Marriott ¬•11,244 (~$75), Four Points ¬•13,500 (~$90), Mesm Tokyo ¬•14,802 (~$99)
- Cherry blossom premium late March (50-100% spike from Mar 20+)
- Data saved: `~/projects/marriott-scanner/scripts/tokyo-data.json`
- PDF: `tokyo-hotels-mar-2026.pdf`

### Tustin, CA (2 hotels, Feb + April 2026)
- Only 2 Marriott properties in Tustin, both on Newport Ave
- **SNATU** - Residence Inn Tustin OC (4.2‚òÖ, 910 reviews) - Low: $63
- **SNATF** - Fairfield Inn & Suites Tustin OC (4.2‚òÖ, 1128 reviews) - Low: $45
- April pattern: Fairfield $45 every Sunday, Residence Inn $63 on select dates
- PDFs: `tustin-hotels-feb-2026.pdf`, `tustin-hotels-apr-2026.pdf`
- Nam asked for Tustin ‚Äî likely related to home base in OC

### Scanner Notes
- Browser relay (non-headless Brave) still the only working method
- Navigate to month by clicking "Next Month" button (ref e20) ‚Äî works reliably
- Property codes from URL slugs (e.g., marriott.com/hotels/travel/snatu-...)
- Calendar URL pattern: `availabilityCalendar.mi?propertyCode=CODE&isRateCalendar=true&clusterCode=corp&corporateCode=MMP`

## MMP Hotel Registry Scraped (Late Night)
- Scraped all 147 Marriott country sitemaps + 52 US state pages
- **8,995 hotels** across **145 countries**
- USA alone: 5,444 hotels (Texas 633, Florida 534 biggest)
- China/HK: 724, Canada: 297, Mexico: 296
- Saved to: `~/projects/marriott-scanner/scripts/hotels-registry.json`
- Total pages scraped: 198 (took ~1.5 hours via CDP browser relay)

## PDF Generator v2
- Redesigned per Nam's feedback: simplified to 2 colors (green deals + dark gray normal)
- Matrix table at top (hotels √ó dates, grouped by tier) like the dark theme screenshot
- Calendar cards below ‚Äî one per hotel page, symmetrical square boxes
- Light theme only (dark deprecated)
- File: `scripts/pdf-generator.js`

## Convex Upload Complete
- Uploaded all 8,995 hotels to Convex `hotels` table
- 8,966 new inserts + 29 existing hotels updated
- Created `hotels:bulkUpsert` mutation for batch uploads
- Deployed to dev (sleek-guanaco-39) and prod (proper-platypus-320)
- Scanner prices will auto-push via existing `saveMmpRates` mutation
- Nam wants all data in Convex for historical analysis and future website display

## Akamai Block During Dubai Scan
- 29-hotel continuous scan triggered Akamai after hotel 20
- Lesson: keep batches ‚â§10-12 hotels per scan session
- Data from first 20 hotels was lost (process killed before save)
- Need to add incremental save (save after each hotel, not just at end)
- Also need to add Akamai cooldown: if blocked, wait 60+ min before retry

## Mobile API Reverse Engineering ‚Äî TODO
- Nam wants to try Bonvoy mobile app API capture when back in California
- Needs mitmproxy setup on home network + OpenClaw running locally
- This is the endgame for scalable MMP scanning (no Akamai, no browser needed)
- **Reminder needed:** When Nam is back in CA with OpenClaw at home
